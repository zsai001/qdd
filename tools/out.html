
            <!DOCTYPE html>
            <html lang="zh-CN">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Rendered Markdown</title>
                <style>
                    /* 添加额外的全局样式 */
                    body {
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
                        line-height: 1.6;
                        padding: 20px;
                        max-width: 800px;
                        margin: 0 auto;
                    }
                </style>
                <link type="text/css" rel="stylesheet" href="https://cdn-doocs.oss-cn-shenzhen.aliyuncs.com/npm/highlight.js@11.5.1/styles/atom-one-dark.min.css" id="hljs">
            </head>
            <body>
                <h1 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:2em auto 1em;padding:0 1em;border-bottom:2px solid #FF5733;color:#3f3f3f">Python装饰器：从基础语法到高级应用</h1><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">作为一个Python开发者，我发现很多人对装饰器的概念感到困惑。今天，我想和大家分享Python装饰器的知识，从最基础的语法开始，逐步深入到更复杂的用法。</p><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">1. 装饰器的基本概念</h2><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">装饰器本质上是一个函数，它接受一个函数作为参数，并返回一个新的函数。我们用<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">@</code>符号来使用装饰器。</p><h3 style="text-align:left;line-height:1.2;font-family:default-font;font-size:16pxpx;font-weight:bold;margin:2em 8px 0.75em 0;padding-left:8px;border-left:3px solid #FF5733;color:#3f3f3f">1.1 最简单的装饰器</h3><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">让我们从最简单的装饰器开始：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">simple_decorator</span>(<span class="hljs-params">func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Something&nbsp;is&nbsp;happening&nbsp;before&nbsp;the&nbsp;function&nbsp;is&nbsp;called.&quot;</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;func()<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Something&nbsp;is&nbsp;happening&nbsp;after&nbsp;the&nbsp;function&nbsp;is&nbsp;called.&quot;</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/><br/><span class="hljs-meta">@simple_decorator</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">say_hello</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello!&quot;</span>)<br/><br/>say_hello()</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">输出：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-plaintext" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap">Something&nbsp;is&nbsp;happening&nbsp;before&nbsp;the&nbsp;function&nbsp;is&nbsp;called.<br/>Hello!<br/>Something&nbsp;is&nbsp;happening&nbsp;after&nbsp;the&nbsp;function&nbsp;is&nbsp;called.</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">这个例子展示了装饰器的基本工作原理。<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">@simple_decorator</code>语法等同于<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">say_hello = simple_decorator(say_hello)</code>。</p><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">2. 带参数的函数装饰器</h2><h3 style="text-align:left;line-height:1.2;font-family:default-font;font-size:16pxpx;font-weight:bold;margin:2em 8px 0.75em 0;padding-left:8px;border-left:3px solid #FF5733;color:#3f3f3f">2.1 装饰带参数的函数</h3><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">如果被装饰的函数有参数，我们需要在wrapper函数中处理这些参数：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">logging_decorator</span>(<span class="hljs-params">func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args,&nbsp;**kwargs</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Calling&nbsp;function&nbsp;<span class="hljs-subst">{func.__name__}</span>&quot;</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;func(*args,&nbsp;**kwargs)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Function&nbsp;<span class="hljs-subst">{func.__name__}</span>&nbsp;returned&nbsp;<span class="hljs-subst">{result}</span>&quot;</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/><br/><span class="hljs-meta">@logging_decorator</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">sum_two_numbers</span>(<span class="hljs-params">a,&nbsp;b</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;a&nbsp;+&nbsp;b<br/><br/><span class="hljs-built_in">print</span>(sum_two_numbers(<span class="hljs-number">3</span>,&nbsp;<span class="hljs-number">5</span>))</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">输出：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-plaintext" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap">Calling&nbsp;function&nbsp;sum_two_numbers<br/>Function&nbsp;sum_two_numbers&nbsp;returned&nbsp;8<br/>8</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">这里，<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">*args</code>和<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">**kwargs</code>允许wrapper函数接受任意数量的位置参数和关键字参数。</p><h3 style="text-align:left;line-height:1.2;font-family:default-font;font-size:16pxpx;font-weight:bold;margin:2em 8px 0.75em 0;padding-left:8px;border-left:3px solid #FF5733;color:#3f3f3f">2.2 装饰器本身带参数</h3><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">有时我们需要装饰器本身能够接受参数。这就需要再添加一层封装：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">repeat</span>(<span class="hljs-params">times</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">decorator</span>(<span class="hljs-params">func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args,&nbsp;**kwargs</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">for</span>&nbsp;_&nbsp;<span class="hljs-keyword">in</span>&nbsp;<span class="hljs-built_in">range</span>(times):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;result&nbsp;=&nbsp;func(*args,&nbsp;**kwargs)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;result<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;decorator<br/><br/><span class="hljs-meta">@repeat(<span class="hljs-params"><span class="hljs-number">3</span></span>)</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">greet</span>(<span class="hljs-params">name</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Hello,&nbsp;<span class="hljs-subst">{name}</span>!&quot;</span>)<br/><br/>greet(<span class="hljs-string">&quot;Alice&quot;</span>)</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">输出：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-plaintext" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap">Hello,&nbsp;Alice!<br/>Hello,&nbsp;Alice!<br/>Hello,&nbsp;Alice!</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">这个例子中，<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">@repeat(3)</code>实际上是在调用<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">repeat</code>函数，该函数返回真正的装饰器。</p><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">3. 保留被装饰函数的元信息</h2><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">当我们使用装饰器时，被装饰函数的一些元信息（如函数名、文档字符串等）可能会丢失。使用<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">functools.wraps</code>可以解决这个问题：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">from</span>&nbsp;functools&nbsp;<span class="hljs-keyword">import</span>&nbsp;wraps<br/><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">preserving_metadata</span>(<span class="hljs-params">func</span>):<br/><span class="hljs-meta">&nbsp;&nbsp;&nbsp;&nbsp;@wraps(<span class="hljs-params">func</span>)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args,&nbsp;**kwargs</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">&quot;&quot;&quot;This&nbsp;is&nbsp;the&nbsp;wrapper&nbsp;function&quot;&quot;&quot;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;func(*args,&nbsp;**kwargs)<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/><br/><span class="hljs-meta">@preserving_metadata</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">greet</span>(<span class="hljs-params">name</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-string">&quot;&quot;&quot;This&nbsp;function&nbsp;greets&nbsp;a&nbsp;person&quot;&quot;&quot;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Hello,&nbsp;<span class="hljs-subst">{name}</span>!&quot;</span>)<br/><br/><span class="hljs-built_in">print</span>(greet.__name__)&nbsp;&nbsp;<span class="hljs-comment">#&nbsp;输出:&nbsp;greet</span><br/><span class="hljs-built_in">print</span>(greet.__doc__)&nbsp;&nbsp;&nbsp;<span class="hljs-comment">#&nbsp;输出:&nbsp;This&nbsp;function&nbsp;greets&nbsp;a&nbsp;person</span></code></pre><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">4. 类装饰器</h2><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">装饰器不仅可以是函数，还可以是类。类装饰器主要依靠类的<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">__call__</code>方法来实现装饰器功能：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">class</span>&nbsp;<span class="hljs-title class_">CountCalls</span>:<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,&nbsp;func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-variable language_">self</span>.func&nbsp;=&nbsp;func<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-variable language_">self</span>.count&nbsp;=&nbsp;<span class="hljs-number">0</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">__call__</span>(<span class="hljs-params">self,&nbsp;*args,&nbsp;**kwargs</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-variable language_">self</span>.count&nbsp;+=&nbsp;<span class="hljs-number">1</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">{self.func.__name__}</span>&nbsp;has&nbsp;been&nbsp;called&nbsp;<span class="hljs-subst">{self.count}</span>&nbsp;times&quot;</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-variable language_">self</span>.func(*args,&nbsp;**kwargs)<br/><br/><span class="hljs-meta">@CountCalls</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">say_hello</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Hello!&quot;</span>)<br/><br/>say_hello()<br/>say_hello()</code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">输出：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-plaintext" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap">say_hello&nbsp;has&nbsp;been&nbsp;called&nbsp;1&nbsp;times<br/>Hello!<br/>say_hello&nbsp;has&nbsp;been&nbsp;called&nbsp;2&nbsp;times<br/>Hello!</code></pre><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">5. 多个装饰器的应用顺序</h2><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">当多个装饰器应用到同一个函数时，执行顺序是从下到上的：</p><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">bold</span>(<span class="hljs-params">func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">&quot;&lt;b&gt;&quot;</span>&nbsp;+&nbsp;func()&nbsp;+&nbsp;<span class="hljs-string">&quot;&lt;/b&gt;&quot;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">italic</span>(<span class="hljs-params">func</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">wrapper</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">&quot;&lt;i&gt;&quot;</span>&nbsp;+&nbsp;func()&nbsp;+&nbsp;<span class="hljs-string">&quot;&lt;/i&gt;&quot;</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;wrapper<br/><br/><span class="hljs-meta">@bold</span><br/><span class="hljs-meta">@italic</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">greet</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">&quot;Hello,&nbsp;world!&quot;</span><br/><br/><span class="hljs-built_in">print</span>(greet())&nbsp;&nbsp;<span class="hljs-comment">#&nbsp;输出:&nbsp;&lt;b&gt;&lt;i&gt;Hello,&nbsp;world!&lt;/i&gt;&lt;/b&gt;</span></code></pre><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">这里，<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">italic</code>装饰器先被应用，然后是<code style="text-align:left;line-height:1.75;font-family:default-font;font-size:90%;color:#d14;background:rgba(27,31,35,.05);padding:3px 5px;border-radius:4px">bold</code>装饰器。</p><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">6. 实际应用示例</h2><h3 style="text-align:left;line-height:1.2;font-family:default-font;font-size:16pxpx;font-weight:bold;margin:2em 8px 0.75em 0;padding-left:8px;border-left:3px solid #FF5733;color:#3f3f3f">6.1 Flask中的路由装饰器</h3><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">from</span>&nbsp;flask&nbsp;<span class="hljs-keyword">import</span>&nbsp;Flask<br/><br/>app&nbsp;=&nbsp;Flask(__name__)<br/><br/><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">home</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">&#x27;Welcome&nbsp;to&nbsp;my&nbsp;website!&#x27;</span><br/><br/><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/user/&lt;username&gt;&#x27;</span></span>)</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">user_profile</span>(<span class="hljs-params">username</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">f&#x27;User:&nbsp;<span class="hljs-subst">{username}</span>&#x27;</span></code></pre><h3 style="text-align:left;line-height:1.2;font-family:default-font;font-size:16pxpx;font-weight:bold;margin:2em 8px 0.75em 0;padding-left:8px;border-left:3px solid #FF5733;color:#3f3f3f">6.2 自定义认证装饰器</h3><pre class="hljs code__pre" style="text-align:left;line-height:1.5;font-family:default-font;font-size:14px;overflow-x:auto;border-radius:8px;padding:1em;margin:10px 8px"><code class="language-python" style="text-align:left;line-height:1.75;font-family:Menlo, Operator Mono, Consolas, Monaco, monospace;font-size:14px;margin:0;white-space:nowrap"><span class="hljs-keyword">from</span>&nbsp;functools&nbsp;<span class="hljs-keyword">import</span>&nbsp;wraps<br/><span class="hljs-keyword">from</span>&nbsp;flask&nbsp;<span class="hljs-keyword">import</span>&nbsp;abort,&nbsp;g<br/><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">admin_required</span>(<span class="hljs-params">f</span>):<br/><span class="hljs-meta">&nbsp;&nbsp;&nbsp;&nbsp;@wraps(<span class="hljs-params">f</span>)</span><br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">decorated_function</span>(<span class="hljs-params">*args,&nbsp;**kwargs</span>):<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">if</span>&nbsp;<span class="hljs-keyword">not</span>&nbsp;g.user.is_admin:<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;abort(<span class="hljs-number">403</span>)<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;f(*args,&nbsp;**kwargs)<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;decorated_function<br/><br/><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&quot;/admin&quot;</span></span>)</span><br/><span class="hljs-meta">@admin_required</span><br/><span class="hljs-keyword">def</span>&nbsp;<span class="hljs-title function_">admin_page</span>():<br/>&nbsp;&nbsp;&nbsp;&nbsp;<span class="hljs-keyword">return</span>&nbsp;<span class="hljs-string">&quot;Welcome,&nbsp;admin!&quot;</span></code></pre><h2 style="text-align:center;line-height:1.75;font-family:default-font;font-size:NaNpx;font-weight:bold;display:table;margin:4em auto 2em;padding:0 0.2em;background:#FF5733;color:#fff">小结</h2><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">装饰器是Python中非常强大的特性，它允许我们以非侵入式的方式修改或增强函数的行为。从简单的函数装饰器到复杂的参数化类装饰器，我们可以用它们实现各种功能，如日志记录、访问控制、性能测量等。</p><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">在实际开发中，特别是在使用Web框架如Flask或Django时，你会经常遇到并使用装饰器。理解和掌握装饰器不仅能让你的代码更加简洁、模块化，还能帮助你更好地理解和使用各种Python框架。</p><p style="text-align:justify;line-height:1.75;font-family:default-font;font-size:14px;margin:1.5em 8px;letter-spacing:0.1em;color:#3f3f3f">希望这篇文章能帮助你更深入地理解Python装饰器。如果你有任何问题或想法，欢迎在评论区讨论。</p>
      <style>
      .preview-wrapper pre::before {
          position: absolute;
          top: 0;
          right: 0;
          color: #ccc;
          text-align: center;
          font-size: 0.8em;
          padding: 5px 10px 0;
          line-height: 15px;
          height: 15px;
          font-weight: 600;
      }
      </style>
    
            <style>
                .hljs.code__pre::before {
                position: initial;
                padding: initial;
                content: '';
                display: block;
                height: 25px;
                background-color: transparent;
                background-image: url("https://doocs.oss-cn-shenzhen.aliyuncs.com/img/123.svg");
                background-position: 14px 10px!important;
                background-repeat: no-repeat;
                background-size: 40px!important;
                }

                .hljs.code__pre {
                padding: 0!important;
                }

                .hljs.code__pre code {
                display: -webkit-box;
                padding: 0.5em 1em 1em;
                overflow-x: auto;
                text-indent: 0;
                }
            </style>
            
            </body>
            </html>
            